
import java.text.SimpleDateFormat



plugins {
  id 'java'
  id 'maven-publish'
  id 'com.palantir.git-version' version '0.12.2'
}

repositories {
  mavenLocal()
  mavenCentral()
}

sourceCompatibility = 1.11
version = '0.99-SNAPSHOT'

configurations.all {
  resolutionStrategy.cacheChangingModulesFor 0, 'seconds'
}


dependencies {
  testCompile 'junit:junit:4.12'
}

def gitDetails = versionDetails();

jar {
  manifest {
    attributes(
            "Main-Class"     : "com.needhamsoftware.unojar.Boot",
            'Built-By'       : System.properties['user.name'],
            'Build-Timestamp': new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSSZ").format(new Date()),
            'Build-Revision' : version + ' ('+gitDetails.gitHashFull+')' + (gitDetails.isCleanTag ? '' : '(with uncommitted files)') ,
            'Created-By'     : "Gradle ${gradle.gradleVersion}",
            'Build-Jdk'      : "${System.properties['java.version']} (${System.properties['java.vendor']} ${System.properties['java.vm.version']})",
            'Build-OS'       : "${System.properties['os.name']} ${System.properties['os.arch']} ${System.properties['os.version']}"
    )
  }
  from('../') {
    include 'LICENSE.txt'
    include 'NOTICE.txt'
  }
}

publishing {
  publications {
    mavenJava(MavenPublication) {
      groupId 'com.needhamsoftware.unojar'
      artifactId 'core'
      version project.version
      from components.java
    }
  }
}







